"use strict";var $paginator=void 0,items=void 0;function clearField(a,t){getmdlSelect.init(".mdl-filter"+a),document.getElementsByClassName("mdl-filter"+a)[0].classList.remove("is-dirty"),t.style.display="none"}function objaviStatus(){var a=$("#trenutniUporabnik").val();if($("#status"+a).html($("#currStatus").val()),""!=$("#currStatus").val()){var t={currStatus:$("#currStatus").val()};$.ajax({url:"/status",type:"POST",contentType:"application/json",data:JSON.stringify(t),success:function(){$("#currStatus").val("");document.querySelector("#mainToast").MaterialSnackbar.showSnackbar({message:"Status je bil uspešno posodobljen!"})},error:function(a,t,e){document.querySelector("#mainToast").MaterialSnackbar.showSnackbar({message:"Prišlo je do napake, status ni bil shranjen!"})}})}}function updateItems(){items=$(".paginate"),$paginator.pagination("updateItems",items.length);var a=Math.min($paginator.pagination("getCurrentPage"),$paginator.pagination("getPagesCount"));$paginator.pagination("selectPage",a),24<items.length&&$("#pagination").attr("style","display: list-view")}function queryNaloge(){var a={};""!=$("input[name='osebaSearch']").val()&&(a.oseba=$("input[name='osebaSearch']").val()),""!=$("#statusSearch").val()&&(a.status=$("input[name='statusSearch']").val()),""!=$("input[name='kategorijaSearch']").val()&&(a.kategorija=$("input[name='kategorijaSearch']").val()),""!=$("input[name='avtorSearch']").val()&&(a.avtor=$("input[name='avtorSearch']").val()),""!=$("#koledarSearch").val()&&(a.koledar=$("#koledarSearch").val()),""!=$("#ciljSearch").val()&&(a.cilj=$("#ciljSearch").val()),$.ajax({url:"/prikazi_naloge",type:"POST",data:a,success:function(a){$("#nalogeGrid").html(a),updateItems(),function(a,t){var e=document.getElementById("nalogeGrid").getElementsByClassName("mdl-card"),l=void 0;for(l=0;l<e.length;l++)e[l].onclick=function(a){return function(){t(a,event)}}(e[l])}(0,function(a,t){currentElement=a,posodobiNalogo(),$("#newDialog").val(a.getElementsByClassName("idNaloga")[0].value),$("#imeDialog").val(a.getElementsByClassName("mdl-list__item-text-body")[0].previousElementSibling.innerHTML).parent().addClass("is-dirty"),$("#opisDialog").val(a.getElementsByClassName("mdl-list__item-text-body")[0].innerHTML).parent().addClass("is-dirty");var e=void 0,l=void 0;try{e=a.getElementsByClassName("dateNaloga")[0].innerHTML,l=a.getElementsByClassName("dateNaloga")[1].innerHTML}catch(a){console.log(a)}e&&($("#targetZacetek").val(e).parent().addClass("is-dirty"),$("#dateZacetek").val(moment(e.replace(" ob "," "),"DD-MM-Y HH:mm").format("Y-MM-DD HH:mm"))),l&&($("#targetKonec").val(l).parent().addClass("is-dirty"),$("#dateKonec").val(moment(l.replace(" ob "," "),"DD-MM-Y HH:mm").format("Y-MM-DD HH:mm")));var i=a.getElementsByClassName("kategorijaNaloga")[0].value;$("#kategorija").get(0).placeholder=$(".list-kategorija").find("[data-val="+i+"]").get(0).textContent.trim(),$("input[name='sampleKategorija']").parent().addClass("is-dirty").find("li[data-val="+i+"]").attr("data-selected","true"),getmdlSelect.init("#dialogKategorija");var n=a.getElementsByClassName("ciljNaloga")[0].value;$("#vezanCilj").get(0).placeholder=$(".list-cilj").find("[data-val="+n+"]").get(0).textContent.trim(),$("input[name='sampleCilj']").parent().addClass("is-dirty").find("li[data-val="+n+"]").attr("data-selected","true"),getmdlSelect.init("#dialogCilj");var s=a.getElementsByClassName("statusNaloga")[0].innerHTML;"Neopravljena"==($("#statusNaloge").get(0).placeholder=s)?($("#statusNaloge").parent().addClass("is-dirty").find("li[data-val=false]").attr("data-selected","true"),$("input[name='oldStatus']").val("false"),$("input[name='newStatus']").val("false")):($("#statusNaloge").parent().addClass("is-dirty").find("li[data-val=true]").attr("data-selected","true"),$("input[name='oldStatus']").val("true"),$("input[name='newStatus']").val("true")),getmdlSelect.init("#dialogStatus"),$("#xpNaloge").val(a.getElementsByClassName("xpNaloga")[0].innerHTML.match(/\d/g).join("")).parent().addClass("is-dirty");var r=a.getElementsByClassName("udelezenecNaloga"),o=$("input:checkbox[name='person']");$("#checkboxVsi").parent()[0].MaterialCheckbox.uncheck(),o.length-1==r.length&&$("#checkboxVsi").parent()[0].MaterialCheckbox.check();for(var c,d=0,m=1;m<o.length;m++)if((c=$("#"+o[m].id).parent()[0].MaterialCheckbox).uncheck(),r[d].value==o[m].value){c.check(),d++;break}t.stopPropagation()})},error:function(a,t,e){alert(a.status),alert(a.responseText),alert(e)}}),updateItems()}jQuery(function(n){n("#osebaSearch").get(0).onchange=function(){n("#chipOseba").attr("style","display: inline-block;").find("span:first-child").text(n(this).val())},n("#statusSearch").get(0).onchange=function(){n("#chipStatus").attr("style","display: inline-block;").find("span:first-child").text(n(this).val())},n("#kategorijaSearch").get(0).onchange=function(){n("#chipKategorija").attr("style","display: inline-block;").find("span:first-child").text(n(this).val())},n("#avtorSearch").get(0).onchange=function(){n("#chipAvtor").attr("style","display: inline-block;").find("span:first-child").text(n(this).val())},n("#koledarSearch").get(0).onchange=function(){n("#chipKoledar").attr("style","display: inline-block;").find("span:first-child").text(n(this).val())},n("#ciljSearch").get(0).onchange=function(){n("#chipCilj").attr("style","display: inline-block;").find("span:first-child").text(n(this).val())},($paginator=n("#pagination")).pagination({itemsOnPage:24,cssStyle:"light-theme",onPageClick:function(a){var t=n(document).width(),e=24*(a-1),l=e+24;n(".naloge-center").attr("style","display: none!important");for(var i=e;i<=l;i++)1440<t?(n("#cellHa"+i).attr("style","display: block!important"),n("#cellHb"+i).attr("style","display: block!important")):840<t&&(n("#cellPa"+i).attr("style","display: block!important"),n("#cellPb"+i).attr("style","display: block!important"));items.hide().slice(e,l).show()}}),n("#filter").click(function(){queryNaloge()}),n("#reset").click(function(){getmdlSelect.init(".mdl-filter"),n(".selected").removeClass("selected"),n("input[name='osebaSearch']").val("").parent().removeClass("is-dirty"),n("#statusSearch").val("").parent().removeClass("is-dirty"),n("input[name='kategorijaSearch']").val("").parent().removeClass("is-dirty"),n("input[name='avtorSearch']").val("").parent().removeClass("is-dirty"),n("#koledarSearch").val("").parent().removeClass("is-dirty"),n("#ciljSearch").val("").parent().removeClass("is-dirty")})});